# 问答示例功能使用说明

## 功能概述

问答示例功能通过 Few-shot Learning 技术，允许用户配置高质量的问答示例来提升 SQL 生成的准确性。系统会基于语义相似度自动匹配相关示例，并将其作为参考融入到 AI 提示词中。

## 主要功能

### 1. 问答示例管理
- **创建示例**：手动创建问题-SQL对，包含分类、描述等元信息
- **编辑示例**：修改现有示例的内容、分类和状态
- **启用/禁用**：控制示例是否参与查询匹配
- **批量操作**：支持批量启用、禁用和删除示例
- **搜索过滤**：按问题内容、SQL内容、分类等筛选示例

### 2. 智能示例匹配
- **语义搜索**：基于向量相似度匹配相关示例
- **动态阈值**：自动调整相关性阈值以确保匹配质量
- **使用统计**：记录示例使用次数和最后使用时间
- **Few-shot集成**：将匹配的示例格式化为高质量提示词

### 3. 对话修正功能
- **一键修正**：在对话页面点击"修正"按钮快速创建示例
- **自动填充**：自动填充用户问题和原始SQL
- **错误记录**：保存错误SQL用于对比分析
- **即时生效**：修正示例立即参与后续查询

## 使用流程

### 步骤1：访问示例管理页面
1. 登录系统后，在左侧导航菜单点击"问答示例"
2. 选择"示例管理"进入示例列表页面
3. 选择要管理的数据库连接

### 步骤2：创建问答示例
1. 点击"创建示例"按钮
2. 填写以下信息：
   - **用户问题**：自然语言描述的查询需求
   - **SQL查询**：对应的标准SQL语句
   - **分类**：选择查询类型（基础/复杂/聚合/连接等）
   - **示例描述**：简要说明示例的作用或注意事项
   - **启用状态**：是否启用该示例
3. 点击确定保存

### 步骤3：在对话中使用
1. 进入数据库对话页面
2. 输入自然语言查询
3. 系统会自动匹配相关示例并生成更准确的SQL
4. 如果结果不满意，可点击"修正"按钮创建新示例

### 步骤4：修正不准确的结果
1. 在AI生成的SQL结果下方点击"修正"按钮
2. 在弹窗中输入正确的SQL查询
3. 添加修正说明（可选）
4. 保存后该示例将用于改进未来查询

## 最佳实践

### 示例创建建议
1. **覆盖常见场景**：为业务中常见的查询模式创建示例
2. **分类明确**：合理使用分类标签便于管理和匹配
3. **SQL质量高**：确保示例SQL语法正确、性能良好
4. **描述详细**：添加清晰的描述帮助理解示例用途

### 查询优化策略
1. **循序渐进**：从简单查询开始，逐步添加复杂示例
2. **及时修正**：遇到错误结果及时使用修正功能
3. **定期维护**：定期检查示例使用情况，更新低效示例
4. **监控效果**：关注示例使用统计，优化高频场景

### 分类推荐
- **basic**：简单的单表查询
- **complex**：涉及多个条件或计算的复杂查询
- **aggregate**：包含聚合函数的统计查询
- **join**：多表关联查询
- **correction**：用户修正生成的示例

## 技术特点

### 向量化存储
- 使用语义向量嵌入技术存储示例
- 支持多种向量存储后端（SQLite、PostgreSQL）
- 高效的相似度搜索算法

### 智能匹配
- 基于Transformer模型的语义理解
- 动态相关性阈值调整
- 多维度相似度计算

### 无缝集成
- 与现有聊天流程深度集成
- 不影响原有功能的使用体验
- 支持实时示例更新

## 注意事项

1. **示例质量**：示例的质量直接影响SQL生成效果，请确保示例准确无误
2. **数量平衡**：过多示例可能影响匹配速度，建议每个连接维护20-50个高质量示例
3. **定期清理**：定期清理无效或过时的示例
4. **权限控制**：确保只有具备SQL知识的用户创建和修改示例

## 常见问题

**Q: 为什么我的示例没有被匹配到？**
A: 检查示例是否已启用，以及用户问题与示例问题的语义相似度是否足够高。

**Q: 如何提高示例匹配的准确性？**
A: 使用更具体和详细的问题描述，合理使用分类，并确保示例覆盖常见查询模式。

**Q: 修正功能创建的示例可以编辑吗？**
A: 可以，修正创建的示例与手动创建的示例具有相同的管理功能。

**Q: 示例会影响查询性能吗？**
A: 语义搜索过程会增加少量延迟（通常<100ms），但对整体查询体验影响很小。
